# éƒ¨ç½²èªªæ˜æŒ‡å—

## ğŸ“‹ æ¶æ§‹æ¦‚è¦½

é€™å€‹å°ˆæ¡ˆåŒ…å« **ä¸‰å€‹ä¸»è¦éƒ¨åˆ†**ï¼Œå®ƒå€‘éƒ¨ç½²åœ¨ä¸åŒçš„åœ°æ–¹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. å¾Œç«¯æœå‹™ï¼ˆé€™å€‹ repo - headless-vector-searchï¼‰          â”‚
â”‚     âœ… å·²éƒ¨ç½²åœ¨ Supabase                                    â”‚
â”‚     - Edge Function (vector-search)                         â”‚
â”‚     - è³‡æ–™åº« schema å’Œå‡½æ•¸                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ API å‘¼å«
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. å‰ç«¯æœå°‹ä»‹é¢ï¼ˆä½ çš„æ–‡æª”ç¶²ç«™ï¼‰                            â”‚
â”‚     âš ï¸ éœ€è¦ä½ è‡ªè¡Œéƒ¨ç½²åœ¨ä½ çš„æ–‡æª”ç¶²ç«™ä¸­                       â”‚
â”‚     - HTML/React/Vue/Next.js ç­‰å‰ç«¯æ‡‰ç”¨                     â”‚
â”‚     - ç”¨æˆ¶çœ‹åˆ°å’Œäº’å‹•çš„æœå°‹ä»‹é¢                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ è³‡æ–™ä¾†æº
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. æ–‡æª”å…§å®¹ï¼ˆä½ çš„æ–‡æª” repoï¼‰                               â”‚
â”‚     âœ… é€é GitHub Actions åŒ¯å…¥åˆ°è³‡æ–™åº«                     â”‚
â”‚     - Markdown æª”æ¡ˆ                                         â”‚
â”‚     - GitHub Action è‡ªå‹•ç”Ÿæˆ embeddings                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ é‡é»ï¼šå‰ç«¯æœå°‹ä»‹é¢ç¨‹å¼ç¢¼éƒ¨ç½²åœ¨å“ªè£¡ï¼Ÿ

### âŒ **ä¸æ˜¯**éƒ¨ç½²åœ¨é€™è£¡ï¼š
- âŒ ä¸æ˜¯åœ¨é€™å€‹ `headless-vector-search` repo
- âŒ ä¸æ˜¯åœ¨ Supabaseï¼ˆSupabase åªè² è²¬å¾Œç«¯ Edge Functionï¼‰
- âŒ ä¸æ˜¯å–®ç¨çš„æœå‹™å™¨

### âœ… **æ˜¯**éƒ¨ç½²åœ¨ä½ çš„æ–‡æª”ç¶²ç«™ä¸­ï¼š

å‰ç«¯æœå°‹ä»‹é¢ç¨‹å¼ç¢¼æ‡‰è©²æ•´åˆåˆ°ä½ **å¯¦éš›å±•ç¤ºæ–‡æª”çµ¦ç”¨æˆ¶çš„å‰ç«¯æ‡‰ç”¨**ä¸­ï¼Œä¾‹å¦‚ï¼š

1. **å¦‚æœä½ çš„æ–‡æª”æ˜¯ç”¨ Next.js å»ºç«‹**ï¼š
   - ç¨‹å¼ç¢¼æ”¾åœ¨ Next.js å°ˆæ¡ˆçš„çµ„ä»¶ä¸­
   - ä¾‹å¦‚ï¼š`components/SearchDialog.tsx`

2. **å¦‚æœä½ çš„æ–‡æª”æ˜¯ç”¨ Vue å»ºç«‹**ï¼š
   - ç¨‹å¼ç¢¼æ”¾åœ¨ Vue å°ˆæ¡ˆçš„çµ„ä»¶ä¸­
   - ä¾‹å¦‚ï¼š`components/SearchModal.vue`

3. **å¦‚æœä½ çš„æ–‡æª”æ˜¯ç”¨ç´” HTML/JavaScript**ï¼š
   - ç¨‹å¼ç¢¼æ”¾åœ¨ HTML æª”æ¡ˆä¸­
   - ä¾‹å¦‚ï¼š`search.html` æˆ–åµŒå…¥åˆ°ç¾æœ‰çš„é é¢

4. **å¦‚æœä½ çš„æ–‡æª”æ˜¯ç”¨å…¶ä»–æ¡†æ¶**ï¼ˆReact, Svelte, Angular ç­‰ï¼‰ï¼š
   - æ•´åˆåˆ°è©²æ¡†æ¶çš„çµ„ä»¶ä¸­

## ğŸ“ å…·é«”å¯¦ä½œæ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šç¢ºèªå¾Œç«¯å·²éƒ¨ç½²ï¼ˆé€™å€‹ repoï¼‰

```bash
# 1. éƒ¨ç½² Edge Function åˆ° Supabase
supabase functions deploy vector-search --no-verify-jwt

# 2. ç¢ºèª Edge Function URL
# åœ¨ Supabase Dashboard > Functions æ‰¾åˆ°ä½ çš„ URL
# ä¾‹å¦‚ï¼šhttps://your-project.supabase.co/functions/v1/vector-search
```

### æ­¥é©Ÿ 2ï¼šåœ¨ä½ çš„æ–‡æª”ç¶²ç«™ä¸­æ·»åŠ å‰ç«¯æœå°‹ä»‹é¢

**ç¯„ä¾‹ï¼šæ•´åˆåˆ° Next.js æ–‡æª”ç¶²ç«™**

```typescript
// components/SearchDialog.tsx (åœ¨ä½ çš„ Next.js å°ˆæ¡ˆä¸­)
'use client'

import { useState } from 'react'

export function SearchDialog() {
  const [query, setQuery] = useState('')
  const [answer, setAnswer] = useState('')
  const [loading, setLoading] = useState(false)

  const handleSearch = async (e: React.FormEvent) => {
    e.preventDefault()
    setAnswer('')
    setLoading(true)

    const projectUrl = process.env.NEXT_PUBLIC_SUPABASE_URL
    const functionUrl = `${projectUrl}/functions/v1/vector-search`
    const url = `${functionUrl}?${new URLSearchParams({ query })}`

    try {
      const response = await fetch(url, {
        headers: {
          'apikey': process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || '',
        }
      })

      // è™•ç† SSE ä¸²æµ...
      // (ä½¿ç”¨ä¹‹å‰æä¾›çš„ fetch API ç¨‹å¼ç¢¼)
    } catch (error) {
      console.error(error)
    }
  }

  return (
    <form onSubmit={handleSearch}>
      <input 
        value={query} 
        onChange={(e) => setQuery(e.target.value)}
        placeholder="æœå°‹æ–‡æª”..."
      />
      <button type="submit">æœå°‹</button>
      {answer && <div>{answer}</div>}
    </form>
  )
}
```

**ç¯„ä¾‹ï¼šæ•´åˆåˆ° Vue æ–‡æª”ç¶²ç«™**

```vue
<!-- components/SearchModal.vue (åœ¨ä½ çš„ Vue å°ˆæ¡ˆä¸­) -->
<template>
  <div class="search-modal">
    <form @submit.prevent="handleSearch">
      <input 
        v-model="query" 
        placeholder="æœå°‹æ–‡æª”..."
      />
      <button type="submit">æœå°‹</button>
    </form>
    <div v-if="loading">è¼‰å…¥ä¸­...</div>
    <div v-else>{{ answer }}</div>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const query = ref('')
const answer = ref('')
const loading = ref(false)

const handleSearch = async () => {
  answer.value = ''
  loading.value = true

  const projectUrl = import.meta.env.VITE_SUPABASE_URL
  const functionUrl = `${projectUrl}/functions/v1/vector-search`
  const url = `${functionUrl}?${new URLSearchParams({ query: query.value })}`

  // ä½¿ç”¨ fetch API è™•ç† SSE...
  // (ä½¿ç”¨ä¹‹å‰æä¾›çš„ç¨‹å¼ç¢¼)
}
</script>
```

## ğŸ” é—œéµç†è§£

### é€™å€‹ repo (`headless-vector-search`) æ˜¯ä»€éº¼ï¼Ÿ

é€™æ˜¯ä¸€å€‹ **ã€ŒHeadlessã€å·¥å…·åŒ…**ï¼Œæ„æ€æ˜¯ï¼š
- âœ… å®ƒæä¾›**å¾Œç«¯ API**ï¼ˆEdge Functionï¼‰
- âœ… å®ƒæä¾›**è³‡æ–™åº«çµæ§‹**
- âŒ å®ƒ**ä¸æä¾›**ç¾æˆçš„å‰ç«¯ UI
- âœ… å®ƒè®“ä½ **è‡ªç”±é¸æ“‡**ä»»ä½•å‰ç«¯æ¡†æ¶ä¾†å»ºç«‹ UI

### ç‚ºä»€éº¼å« "Headless"ï¼Ÿ

å°±åƒ "Headless CMS" çš„æ¦‚å¿µï¼š
- **Headï¼ˆé ­ï¼‰= å‰ç«¯ä»‹é¢**
- **Bodyï¼ˆèº«é«”ï¼‰= å¾Œç«¯ API**
- **Headless = æ²’æœ‰å›ºå®šå‰ç«¯ï¼Œä½ å¯ä»¥è‡ªç”±é¸æ“‡å‰ç«¯**

### å¯¦éš›æ¡ˆä¾‹

çœ‹çœ‹ Supabase å®˜æ–¹æ–‡æª”æ˜¯æ€éº¼åšçš„ï¼š
- å¾Œç«¯ï¼šä½¿ç”¨é€™å€‹ `headless-vector-search` æä¾›çš„ Edge Function
- å‰ç«¯ï¼šä»–å€‘åœ¨è‡ªå·±çš„ Next.js æ–‡æª”ç¶²ç«™ä¸­å»ºç«‹äº†æœå°‹ä»‹é¢
- ç•¶ç”¨æˆ¶æŒ‰ä¸‹ `cmd+k`ï¼Œå°±æœƒå‘¼å«å¾Œç«¯çš„ Edge Function

## ğŸ“š ç¸½çµ

1. **å¾Œç«¯ï¼ˆé€™å€‹ repoï¼‰**ï¼šå·²ç¶“éƒ¨ç½² âœ…
   - Edge Function åœ¨ Supabase
   - è³‡æ–™åº«åœ¨ Supabase

2. **å‰ç«¯æœå°‹ä»‹é¢**ï¼šéœ€è¦ä½ è‡ªè¡Œå»ºç«‹å’Œéƒ¨ç½² âš ï¸
   - åœ¨ä½ çš„æ–‡æª”ç¶²ç«™å°ˆæ¡ˆä¸­
   - å¯ä»¥æ˜¯ä»»ä½•æ¡†æ¶ï¼ˆReact, Vue, Next.js ç­‰ï¼‰
   - ä½¿ç”¨ `search-interface-example.html` ä½œç‚ºåƒè€ƒ

3. **æ–‡æª”å…§å®¹**ï¼šé€é GitHub Actions è‡ªå‹•åŒ¯å…¥ âœ…
   - åœ¨ä½ çš„æ–‡æª” repo ä¸­è¨­å®š GitHub Action
   - è‡ªå‹•å°‡ Markdown è½‰æ›ç‚º embeddings

## ğŸš€ å¿«é€Ÿé–‹å§‹

å¦‚æœä½ æƒ³å…ˆæ¸¬è©¦çœ‹çœ‹ï¼Œå¯ä»¥ç›´æ¥ï¼š

1. é–‹å•Ÿ `search-interface-example.html` æª”æ¡ˆ
2. åœ¨ç€è¦½å™¨ä¸­æ‰“é–‹
3. å¡«å…¥ä½ çš„ Supabase å°ˆæ¡ˆ URL
4. æ¸¬è©¦æœå°‹åŠŸèƒ½

é€™å€‹ HTML æª”æ¡ˆæ˜¯ç¨ç«‹çš„æ¸¬è©¦é é¢ï¼Œä½ å¯ä»¥ï¼š
- ç”¨å®ƒä¾†æ¸¬è©¦ Edge Function æ˜¯å¦æ­£å¸¸å·¥ä½œ
- åƒè€ƒå®ƒçš„ç¨‹å¼ç¢¼ä¾†æ•´åˆåˆ°ä½ çš„å¯¦éš›æ‡‰ç”¨ä¸­
- æ ¹æ“šä½ çš„éœ€æ±‚ä¿®æ”¹æ¨£å¼å’ŒåŠŸèƒ½

